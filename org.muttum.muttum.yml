---
# SPDX-FileCopyrightText: 2025 Adrien Dorsaz
# SPDX-License-Identifier: GPL-3.0-or-later

id: org.muttum.muttum
runtime: org.gnome.Platform
runtime-version: "48"
sdk: org.gnome.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.rust-stable
command: muttum
finish-args:
  - --device=dri
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
build-options:
  append-path: /usr/lib/sdk/rust-stable/bin
cleanup:
  - /include
  - /lib/pkgconfig
  - /man
  - /share/doc
  - /share/gtk-doc
  - /share/man
  - /share/pkgconfig
  - "*.la"
  - "*.a"
modules:
  - name: data
    buildsystem: simple
    build-commands:
      - install -Dm644 en_US /app/share/org.muttum.muttum/en_US
      - install -Dm644 en_AU /app/share/org.muttum.muttum/en_AU
      - install -Dm644 en_GB /app/share/org.muttum.muttum/en_GB
      - install -Dm644 en_CA /app/share/org.muttum.muttum/en_CA
      - install -Dm644 en.license /app/share/org.muttum.muttum/en.license
      - install -Dm644 de_AT /app/share/org.muttum.muttum/de_AT
      - install -Dm644 de_CH /app/share/org.muttum.muttum/de_CH
      - install -Dm644 de_DE /app/share/org.muttum.muttum/de_DE
      - install -Dm644 de.license /app/share/org.muttum.muttum/de.license
      - install -Dm644 fr /app/share/org.muttum.muttum/fr
      - install -Dm644 fr.license /app/share/org.muttum.muttum/fr.license
      - install -Dm644 muttum.toml /app/etc/xdg/org.muttum.muttum/muttum.toml
    sources:
      - type: archive
        url: "https://gitlab.adorsaz.ch/muttum/muttum/-/releases/\
              25.06.4/downloads/dist/dictionaries-25.06.4.tar.xz"
        sha256: b4b447524d72835d06a88b93c867cd12a68e880bb4c084c7d97b175d8d14c937
  - name: muttum
    buildsystem: meson
    build-options:
      env:
        CARGO_NET_OFFLINE: 'true'
    config-opts:
      - -Dbuildtype=release
    sources:
      - type: archive
        url: "https://gitlab.adorsaz.ch/muttum/muttum/-/releases/\
              25.06.4/downloads/dist/muttum-25.06.4.tar.xz"
        sha256: f7176acaa6686e3a73ee1e340ce98ebf3e98a66a4358028989c25acbaf1bec4a
